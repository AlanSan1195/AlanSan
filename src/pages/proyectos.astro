---
import Layout from "../layouts/Layout.astro";
import ProjectData from "../data/projects.json";

// Obtener todos los proyectos ordenados por order (más reciente primero)
const projectsArray = Object.values(ProjectData);
const selectedProjects = projectsArray
  .filter((project) => project.id)
  .sort((a, b) => b.order - a.order);

const pageTitle = "Proyectos | Alan San - Desarrollador Frontend";
const pageDescription = `Explora ${selectedProjects.length} proyectos de desarrollo web: aplicaciones React, landing pages con animaciones GSAP, juegos en Canvas y más. Portfolio de Alan San, desarrollador frontend en Guadalajara.`;

// JSON-LD para la colección de proyectos
const projectsJsonLd = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  name: pageTitle,
  description: pageDescription,
  url: "https://alansan.dev/proyectos",
  mainEntity: {
    "@type": "ItemList",
    numberOfItems: selectedProjects.length,
    itemListElement: selectedProjects.map((project, index) => ({
      "@type": "ListItem",
      position: index + 1,
      url: `https://alansan.dev/${project.id}`,
      name: project.title,
    })),
  },
};
---

<Layout
  title={pageTitle}
  description={pageDescription}
  image="/imagenes/FotoPerfil.webp"
  jsonLd={projectsJsonLd}
>
  <!-- Back to Portfolio -->
  <section
    class="relative max-w-3xl md:max-w-4xl mx-auto overflow-hidden pt-10 z-10"
  >
    <div class="relative px-4 mb-6">
      <div class="mx-auto mt-2">
        <a
          href="/"
          class="p-2 w-fit bg-[var(--color-bg-secondary)] border-[1.5px] hover:bg-[var(--color-bg-card)] border-[var(--color-border)] outline outline-offset-[0.5px] outline-[var(--color-bg)] ll text-sm text-[var(--color-text-secondary)] hover:text-[var(--color-text)] justify-center flex transition-colors"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
        </a>
      </div>
      <!-- Hero -->

      <h1 class="text-4xl md:text-6xl font-alpha text-[var(--color-text)] mb-6">
        Proyectos
      </h1>
      <p
        class="font-king ligero text-sm md:text-lg text-[var(--color-text-muted)] mb-4 max-w-3xl"
      >
        Lo que me he divertido y aprendido con estos otros de por aqui.  
      </p>
    </div>

    <!-- imagenes Demo Grid -->
    <div class="max-w-3xl md:max-w-4xl mx-auto px-4 mb-32">
      <!-- Grid: 1 columna en mobile, 2 columnas en tablet, 3 columnas en desktop (máximo 2 filas) -->
      <div
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-[3.5fr, 2fr, 2fr] gap-4 md:gap-6"
      >
        {
          selectedProjects.map((project) => (
            <a
              href={`/${project.id}`}
              class="group block transition-transform hover:scale-[1.02] relative border-[1.5px] border-[var(--color-border)] outline outline-offset-[0.5px] outline-[var(--color-bg)] l overflow-hidden aspect-video"
            >
              <img
                transition:name={`transition-${project.id}`}
                src={project.image.srcHero ?? project.image.src}
                alt={project.image.alt}
                class="w-full h-full object-cover"
                loading="lazy"
                width="640"
                height="360"
                decoding="async"
              />

              {/* Overlay con título al hacer hover */}
              <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4">
                <div>
                  <h3 class="text-white font-alpha text-lg md:text-xl">
                    {project.title}
                  </h3>
                  <p class="text-gray-300 font-light text-sm">
                    {project.subTitle}
                  </p>
                </div>
              </div>
            </a>
          ))
        }
      </div>
    </div>
  </section>
</Layout>

<style>
  code {
    font-family: "Courier New", monospace;
    line-height: 1.4;
  }
  .informative {
    font-family: "static";
    font-size: 20px;
    opacity: 0.8;
  }
  .ligero {
    font-weight: 200;
    
  }
</style>
